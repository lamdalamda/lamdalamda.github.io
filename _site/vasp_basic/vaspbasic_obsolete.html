<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Personal webpage | Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Personal webpage" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="http://localhost:4000/vasp_basic/vaspbasic_obsolete.html" />
<meta property="og:url" content="http://localhost:4000/vasp_basic/vaspbasic_obsolete.html" />
<meta property="og:site_name" content="Personal webpage" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Personal webpage" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"Personal webpage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","url":"http://localhost:4000/vasp_basic/vaspbasic_obsolete.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Personal webpage" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Personal webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/vasp_basic/">vasp理论</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/compile/">vasp编译</a><a class="page-link" href="/deploy/">Deploy  Guide</a><a class="page-link" href="/pymatgen/">pymatgen</a><a class="page-link" href="/vasp_inputs/">vasp输入</a><a class="page-link" href="/vasp_practice/">vasp实例</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title"></h1>
  </header>

  <div class="post-content">
    
<ul id="markdown-toc">
  <li><a href="#dft-theory-密度泛函计算基本理论" id="markdown-toc-dft-theory-密度泛函计算基本理论">DFT Theory 密度泛函计算基本理论</a>    <ul>
      <li><a href="#basic-concepts-基本概念如何计算" id="markdown-toc-basic-concepts-基本概念如何计算">basic concepts 基本概念：如何计算</a>        <ul>
          <li><a href="#hohenberg-kohn-1st-theorem-" id="markdown-toc-hohenberg-kohn-1st-theorem-">Hohenberg-Kohn 1st Theorem :</a></li>
          <li><a href="#hohenberg-kohn-2nd-theorem-" id="markdown-toc-hohenberg-kohn-2nd-theorem-">Hohenberg-Kohn 2nd Theorem :</a></li>
          <li><a href="#nr-或者基态电子密度" id="markdown-toc-nr-或者基态电子密度">n(r), 或者基态电子密度</a></li>
          <li><a href="#泛函的具体形式-the-energy-functional" id="markdown-toc-泛函的具体形式-the-energy-functional">泛函的具体形式 the energy functional=？</a></li>
          <li><a href="#kohn-sham-equation" id="markdown-toc-kohn-sham-equation">Kohn-Sham equation</a></li>
          <li><a href="#递归求解" id="markdown-toc-递归求解">递归求解</a></li>
          <li><a href="#结论" id="markdown-toc-结论">结论：</a></li>
        </ul>
      </li>
      <li><a href="#寻找合适的e_xc泛函" id="markdown-toc-寻找合适的e_xc泛函">寻找合适的\(E_{XC}\)泛函</a>        <ul>
          <li><a href="#lda近似计算exc的一种方式" id="markdown-toc-lda近似计算exc的一种方式">LDA近似：计算Exc的一种方式</a></li>
          <li><a href="#gga" id="markdown-toc-gga">GGA</a></li>
          <li><a href="#meta-gga" id="markdown-toc-meta-gga">meta-GGA</a></li>
          <li><a href="#hyper-gga" id="markdown-toc-hyper-gga">hyper-GGA</a></li>
        </ul>
      </li>
      <li><a href="#寻找合适的波函数-hartree-fock" id="markdown-toc-寻找合适的波函数-hartree-fock">寻找合适的波函数-hartree fock</a>        <ul>
          <li><a href="#单个电子与多电子的波函数" id="markdown-toc-单个电子与多电子的波函数">单个电子与多电子的波函数</a></li>
          <li><a href="#hartree-product" id="markdown-toc-hartree-product">Hartree product</a></li>
          <li><a href="#hartree-fock-calculation" id="markdown-toc-hartree-fock-calculation">hartree fock calculation</a></li>
          <li><a href="#dft计算过程总结" id="markdown-toc-dft计算过程总结">DFT计算过程总结</a></li>
          <li><a href="#exc" id="markdown-toc-exc">Exc</a></li>
        </ul>
      </li>
      <li><a href="#一些补充" id="markdown-toc-一些补充">一些补充</a></li>
      <li><a href="#物质的性质-property-of-matters" id="markdown-toc-物质的性质-property-of-matters">物质的性质： property of matters</a>        <ul>
          <li><a href="#bonding" id="markdown-toc-bonding">bonding：</a></li>
          <li><a href="#hartree-atomic-units" id="markdown-toc-hartree-atomic-units">Hartree atomic units</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#晶体学知识-crystallography" id="markdown-toc-晶体学知识-crystallography">晶体学知识 crystallography</a>    <ul>
      <li><a href="#fourier-transformation" id="markdown-toc-fourier-transformation">fourier transformation</a></li>
      <li><a href="#reciprocal-sapce-倒易空间" id="markdown-toc-reciprocal-sapce-倒易空间">reciprocal sapce 倒易空间</a>        <ul>
          <li><a href="#一维理解" id="markdown-toc-一维理解">一维理解</a></li>
          <li><a href="#倒空间的有意义的点q需要满足的条件" id="markdown-toc-倒空间的有意义的点q需要满足的条件">倒空间的有意义的点q需要满足的条件</a></li>
          <li><a href="#一维小晶体的倒空间与布里渊区" id="markdown-toc-一维小晶体的倒空间与布里渊区">一维小晶体的倒空间与布里渊区</a></li>
          <li><a href="#三维大晶体的倒空间与布里渊区" id="markdown-toc-三维大晶体的倒空间与布里渊区">三维大晶体的倒空间与布里渊区</a></li>
        </ul>
      </li>
      <li><a href="#bloch-theorem的推导" id="markdown-toc-bloch-theorem的推导">bloch theorem的推导</a>        <ul>
          <li><a href="#bloch-theorem第一种证明" id="markdown-toc-bloch-theorem第一种证明">bloch theorem第一种证明</a></li>
          <li><a href="#bloch-theorem的第二种证明" id="markdown-toc-bloch-theorem的第二种证明">bloch theorem的第二种证明</a>            <ul>
              <li><a href="#block-theorem单电子波函数的本征值和周期性" id="markdown-toc-block-theorem单电子波函数的本征值和周期性">block theorem单电子波函数的本征值和周期性</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#k-point取样" id="markdown-toc-k-point取样">k point取样</a>        <ul>
          <li><a href="#trapezoidal-method" id="markdown-toc-trapezoidal-method">trapezoidal method</a></li>
          <li><a href="#gaussian-quadrature" id="markdown-toc-gaussian-quadrature">Gaussian quadrature</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#hubbard-model" id="markdown-toc-hubbard-model">Hubbard model</a>    <ul>
      <li><a href="#dftu" id="markdown-toc-dftu">DFT+U</a>        <ul>
          <li><a href="#u参数计算方式" id="markdown-toc-u参数计算方式">U参数计算方式</a></li>
          <li><a href="#u-parameter-meaningtranslated" id="markdown-toc-u-parameter-meaningtranslated">U parameter meaning(translated)</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#dft-实践" id="markdown-toc-dft-实践">DFT 实践</a>    <ul>
      <li><a href="#压缩模量-bulk-modulus" id="markdown-toc-压缩模量-bulk-modulus">压缩模量 bulk modulus</a></li>
      <li><a href="#分析表面-slab-models" id="markdown-toc-分析表面-slab-models">分析表面-slab models</a></li>
      <li><a href="#kpoint的数量" id="markdown-toc-kpoint的数量">kpoint的数量</a></li>
      <li><a href="#energy-cutoff" id="markdown-toc-energy-cutoff">energy cutoff</a>        <ul>
          <li><a href="#hard-and-soft-psudopotential" id="markdown-toc-hard-and-soft-psudopotential">hard and soft psudopotential</a></li>
        </ul>
      </li>
      <li><a href="#optimization-method" id="markdown-toc-optimization-method">optimization method</a>        <ul>
          <li><a href="#bisection-method" id="markdown-toc-bisection-method">bisection method</a></li>
          <li><a href="#newton-method" id="markdown-toc-newton-method">newton method</a></li>
          <li><a href="#quasi-newton-method" id="markdown-toc-quasi-newton-method">quasi-newton method</a></li>
          <li><a href="#conjugate-gradient-methodsteepest-descent-method" id="markdown-toc-conjugate-gradient-methodsteepest-descent-method">conjugate-gradient method/steepest descent method</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#reference-book-参考书" id="markdown-toc-reference-book-参考书">reference book 参考书</a></li>
</ul>

<h1 id="dft-theory-密度泛函计算基本理论">DFT Theory 密度泛函计算基本理论</h1>
<p>latex test docs index</p>

<h2 id="basic-concepts-基本概念如何计算">basic concepts 基本概念：如何计算</h2>
<p>摘自David S. Sholl, <em>Density functional Theory</em></p>

<h3 id="hohenberg-kohn-1st-theorem-">Hohenberg-Kohn 1st Theorem :</h3>

<p>The ground-state energy from Schroginger’s equation is a unique functional of the electron density.</p>

<p>OR</p>

<p>ground state electron density uniquely determines all properties: energy/ wavefunction.</p>

<p>基态能量是电子密度分布函数(或者说，基态电子在空间中的密度分布)的泛函
一个基态电子密度对应了唯一的能量、波函数。</p>

<p>问题：泛函形式未知</p>

<h3 id="hohenberg-kohn-2nd-theorem-">Hohenberg-Kohn 2nd Theorem :</h3>

<p>The electron density that minimizes the energy of the overall functional is the true electron density corresponding to the full solution of the schrodinger equation.</p>

<p>使这个泛函结果（能量）最低的电子密度是薛定谔方程的解</p>

<p>-&gt;如果知道了泛函的形式，那么就可以计算出基态电子密度</p>

<h3 id="nr-或者基态电子密度">n(r), 或者基态电子密度</h3>

<p>基态电子密度　\(n_{(r)} = 2\Sigma \phi_i^*(r)\phi_i(r)\)</p>

<p>更清楚一点</p>

\[n_{(x,y,z)} = 2\phi_1^*(x,y,z)\phi_1(x,y,z)+2\phi_2^*(x,y,z)\phi_2(x,y,z)+2\phi_3^*(x,y,z)\phi_3(x,y,z)+.....\]

<p>缩成一维：</p>

<p>\(n_{(x)} = 2\phi_1^*(x)\phi_1(x)+2\phi_2^*(x)\phi_2(x)+2\phi_3^*(x)\phi_3(x)+.....\)，对所有电子</p>

<p>是个期望值一样的东西</p>

<h3 id="泛函的具体形式-the-energy-functional">泛函的具体形式 the energy functional=？</h3>

<p>对于单个电子已知如下：</p>

\[E[\phi_i(r)]=E_{known}[\phi_i(r)]+E_{unknown}[\phi_i(r)]\]

<p>方括号是泛函的意思。泛函类似于函数，函数是输入未知数得到一个结果，或者说数到数的对应。而泛函是输入一个函数得到一个数，或者说函数到数的映射。比如说，一个泛函的形式是从0到1积分，那么输入f(x)=x+1这个函数，得到的是数字1.5。泛函跟函数的表达方式类似，但是把圆括号变成方括号
\(n(r) -- E[] --&gt; E[n(r)]\)</p>

<p>\(E_{known}[]\)是已知的能量泛函，包括电子动能，电子-核与电子-电子</p>

<p>\(E_{unknown}[]\)是未知的能量泛函：交换能</p>

<p>其中</p>

\[E_{known}[\phi_i(r)]=\frac{-\hbar}{m}\Sigma\int\phi_i^*(r)\nabla^2\phi_i(r)d^3r+\int V(r)n(r)d^3r+e^2/2\int \int \frac {n(r)n(r')}{|r-r'|}d^3rd^3r'+E_{ion}\]

<p>缩成一维，对于0号电子\(\phi_0\)</p>

\[E_{known}[\phi_0(x)]=\frac{-\hbar}{m}\Sigma\int\phi_0^*(x)\phi_0''(x)dx+\int V(x)n(x)dx+e^2/2\int \int \frac {n(x)n(x')}{|x-x'|}dxdx'+E_{ion}\]

<p>（不太清楚为什么会有一个求和）</p>

<p>由于前述\(n_{(r)} = 2\Sigma \phi_i^*(r)\phi_i(r)\)</p>

<p>所以虽然不知道是否合理，但是推导出来这个公式，即phi（波函数）和n（r）（电子密度）有同样的泛函</p>

\[E[2\Sigma \phi_i^*(r)\phi_i(r)]=E_{known}[2\Sigma \phi_i^*(r)\phi_i(r)]+E_{unknown}[2\Sigma \phi_i^*(r)\phi_i(r)]\]

<p>也就是说电子密度的泛函的形式与波函数相同，是： 
\(E[]=E_{known}[]+E_{unknown}[]\)</p>

<p>问题：解不出来电子密度n(r)因此需要kohn sham 方程解n(r)</p>

<h3 id="kohn-sham-equation">Kohn-Sham equation</h3>

<p>Kohn-Sham equation是用来找电子密度，即n(r):</p>

<p>Kohn-Sham 方程是:</p>

\[[\frac{-\hbar^2}{2m}\nabla^2+V(r)+V_H(r)+V_{XC}(r)]\phi_i(r)=\epsilon_i\phi_i(r)\]

<p>其中</p>

<p>\(V(r)\)是薛定谔方程中已知的，是电子和所有原子核的相互作用</p>

<p>\(V_H(r)\)是hartree potential，是 coulomb repulsion  between “this electron” and “the total electron density”, 或者说电子i和整个电子密度n(r)之间的coulomb repulsion</p>

<p>\(V_H(r)=e^2\int \frac{n(r')}{|r-r'|}d^3r'\)
理解为以r点的坐标向外积分？</p>

<p>\(V_{XC}\)是未知的，虽然有
\(V_{XC}=\frac{\delta E_{XC}(r)}{\delta n(r)}\)</p>

<p>用人能看懂的方法重新写</p>

<p>对于0号电子,其具有能量\(\epsilon_0\)，缩到一维，波函数满足</p>

\[[\frac{-\hbar^2}{2m}\phi_0''(x)+V(x)+e^2\int \frac{n(x')}{|x-x'|}dx'+V_{XC}(x)]\phi_0(x)=\epsilon_0\phi_0(x)\]

<h3 id="递归求解">递归求解</h3>

<p>如果不考虑Vxc这个未知项目（直接删掉这个项），那么其余部分是可以通过递归来进行精确求解的：
1\猜测一个 初始电子密度</p>

<p>guess a initial trial electron density n(r)</p>

<p>2\ 解kohn sham 方程，得到每一个电子的波函数</p>

<p>solve the kohn-sham equation with n(r), get the \(\phi(r)\)</p>

<p>3\ 计算新的电子密度</p>

<p>通过\(n_{(r)} = 2\Sigma \phi_i^*(r)\phi_i(r)\)</p>

<p>4\ 调整电子密度递归运算</p>

<h3 id="结论">结论：</h3>

<p>通过 Hohenberg-Kohn定理和Kohn-Sham方程，距离比较精确地求解薛定谔方程目前只差一个合适的\(E_{XC}\)泛函</p>

<h2 id="寻找合适的e_xc泛函">寻找合适的\(E_{XC}\)泛函</h2>

<h3 id="lda近似计算exc的一种方式">LDA近似：计算Exc的一种方式</h3>

<p>如前文所讲Exc泛函是很难知道形式的。</p>

<p>Exc只在一种情况下可以知道形式:当n(r)=常数，即uniform electron gas</p>

\[V_{XC}(r)=V^{electron gas}_{XC}[n(r)]\]

<p>*防止混淆,左边是函数\(V_{XC}()\)，右边是泛函\(V^{electron gas}_{XC}[]\)</p>

<p>使用LDA近似后，可以精确地解薛定谔方程，但是这个解不是真实解，因为薛定谔方程中的Exc是假的</p>

<h3 id="gga">GGA</h3>

<p>Use local electron density and the local gradient in the electron density calculation</p>

<p>GGA泛函是局部电子密度，和局部电子密度的梯度的函数</p>

\[V_{XC}^{GGA}(r)=V_{XC}[n(r),\nabla n(r)]\]

<p>一维下：</p>

\[V_{XC}^{GGA}(x)=V_{XC}[n(x),\frac{dn(x)}{dx}]\]

<p>主流有：PW91 和 PBE
由于包括了电子密度一阶导项，所以一般认为GGA会比LDA更加准确，但是也有例外，比如在计算过渡金属的表面能的时候</p>

<h3 id="meta-gga">meta-GGA</h3>

<p>在GGA基础上，还会包含二阶导的信息。实际操作上，二阶导是使用了kinetic energy density of the Kohn Sham orbital:</p>

\[\tau(r)=0.5\sum_{occupied states}|\nabla\phi(r)|^2\]

<p>泛函形式是：
\(V_{XC}^{meta-GGA}[n(r),\nabla n(r),\tau(r)]\)</p>

<h3 id="hyper-gga">hyper-GGA</h3>

<p>看不太懂啥意思，形式更加复杂，包含了部分真实Exc项，但是只有在计算小分子时候效果好，在计算bulk material时候不太行的</p>

<h2 id="寻找合适的波函数-hartree-fock">寻找合适的波函数-hartree fock</h2>

<p>泛函在前文已经基本找好了，这里介绍找波函数的过程</p>

<p>当不考虑Exc时候，可以对KohnSham方程进行比较好的计算：</p>

<h3 id="单个电子与多电子的波函数">单个电子与多电子的波函数</h3>

<p>对于单个电子，其波函数是localized的，可以用类似于\(y=e^{-x^2}\)描述，没有周期性，且在远离x=0的地方y约为0。但是对于晶体等多电子体系，应该使用周期性的波函数，比如\(y=sin^2(x)\)</p>

<h3 id="hartree-product">Hartree product</h3>
<p>当总共只有一个电子时候，</p>

\[h\Chi=E\Chi\]

<p>会得到许多个解 \(\Chi_j\)
对于每个解\(\Chi_1,\Chi_2,\Chi_3,....\)
(假设\(\Chi_1\)对应了最低能量)
对应的能量分别是 \(E_1,E_2,E_3,....\),</p>

<p>其中\(E_1\)是能量最低的基态</p>

<p>对于多个电子体系来说</p>

<p>当忽略了电子-电子相互作用时</p>

<p>Hamiltonian： \(H=h_1+h_2+h_3+...\)</p>

<p>\(h_i\)是第i个电子的动能和势能算符</p>

<p>可以得到
\(\phi(x_1,x_2,....x_n)=\prod{\Chi_{ji}}\)
其中j代表了能级（像上面j=1是基态）</p>

<p>对于基态来讲
\(\phi(x_1,x_2,....x_n)=\Chi_{11}(x_1)\Chi_{12}(x_2)\Chi_{13}(x_3)...\)</p>

<p>能量则是简单相加
\(E=E_{11},E_{12},E_{13},....\),</p>

<p>以上方法求得的波函数由于忽略了电子-电子相互作用，所以存在以下问题：</p>

<p><em>由于电子是费米子，所以当两个电子交换位置时候符号必须改变</em></p>

<p>然而，当电子交换位置时候，按照上式，波函数的正负号没有变化</p>

<p>所以：引入Slater determinant</p>

<p>双电子的Slater determinant:</p>

\[\phi(x_1,x_2)=\frac{1}{\sqrt2}det\left\{\begin{matrix}
\Chi_j(x_1)&amp;\Chi_j(x_2)\\
\Chi_k(x_1)&amp;\Chi_k(x_2)\\
\end{matrix}\right\}\]

\[\phi(x_1,x_2)=\frac{1}{\sqrt2}[\Chi_j(x_1)\Chi_k(x_2)-\Chi_k(x_1)\Chi_j(x_2)]\]

<p>这个波函数满足pauli exclusiong principle：不区分电子， 当电子具有相同坐标时等于0</p>

<h3 id="hartree-fock-calculation">hartree fock calculation</h3>

<p>hartree fock calculation 基于这个假设；原子核位置固定</p>

<p>Kohn sham 方程是
\([\frac{-\hbar^2}{2m}\nabla^2+V(r)+V_H(r)+V_{XC}(r)]\phi_i(r)=\epsilon_i\phi_i(r)\)</p>

<p>而对于<strong>单个</strong>电子,HF calculation是： 
\([\frac{-\hbar^2}{2m}\nabla^2+V(r)+V_H(r)]\phi_i(x)=E_j\Chi_j(x)\)
相比于kohn sham减少了一个Exc项</p>

<p>由前面slater行列式可以看到，如果想要描述一个N个电子体系，那么需要知道\(\Chi_1\)到\(\Chi_N\)</p>

<p>对此，可以找到有限个（K个）函数，即\(\phi_{1}(x)\)到\(\phi_{K}(x)\)，使得这K个函数可以加权相加得到\(\Chi_1\)到\(\Chi_N\)
这K个函数被称为basis set
即：</p>

\[\Chi_j(x)=\sum^K_{i=1}\alpha_{j,i}\phi_{i}(x)\]

<p>写的清楚一点，对第一个\(\Chi_1(x)\)：</p>

\[\Chi_1(x)=\alpha_{1,1}\phi_{1}(x)+\alpha_{1,2}\phi_{2}(x)+...+\alpha_{1,K}\phi_{K}(x)\]

<p>现在已知\(\phi_{1}(x)\)到\(\phi_{K}(x)\)，问题变成了找到\(\alpha_{j,i}\)</p>

<p>找到\(\alpha_{i,j}\)的方式：继续进行递归运算：</p>

<p>1, 猜测一组初始的\(\alpha_{j,i}\)</p>

<p>2，通过这个初始的\(\alpha_{j,i}\)计算出来一组n(r)</p>

<p>3, n(r)代回\(\Chi_j(x)=\sum^K_{i=1}\alpha_{j,i}\phi_{i}(x)\)方程，求解\(\alpha_{j,i}\)</p>

<p>通过这个递归运算，可以得到一个精确的能量值，这个能量值是Hartree fock limit.</p>

<p>这个值虽然精确，但并不是实际的电子能量， 因为没有考虑到Exc，即Hartree fock方法实际上并没有解决电子-电子相互作用</p>

<h3 id="dft计算过程总结">DFT计算过程总结</h3>

<p>结合上文Kohn sham 方程计算，完整的DFT计算过程如下：</p>

<p>1, 猜测一组初始的\(\alpha_{j,i}\)</p>

<p>2，通过这个初始的\(\alpha_{j,i}\)计算出来一组n(r)</p>

<p>3，通过这个n(r) 解kohn sham方程 （或者不含Exc的Kohn sham方程，这个时候计算的是hartree fock limitx），得到每一个电子的波函数</p>

<p>4, 用每一个电子波函数计算n(r)</p>

<p>（通过\(n_{(r)} = 2\Sigma \phi_i^*(r)\phi_i(r)\)）</p>

<p>5，将n(r)代回\(\Chi_j(x)=\sum^K_{i=1}\alpha_{j,i}\phi_{i}(x)\)方程，求解\(\alpha_{j,i}\)</p>

<p>6，得到的\(\alpha_{j,i}\)代回第二步</p>

<h3 id="exc">Exc</h3>

<p>Electron correlation energy = True system energy - Hartree fock limit.</p>

<p>即Exc就是实际的能量减去Hartree fock limit</p>

<h2 id="一些补充">一些补充</h2>
<p>参考书：Richard M. Martin <em>Electronic structure: Basic theory and practical method</em></p>

<h2 id="物质的性质-property-of-matters">物质的性质： property of matters</h2>

<p>物质属性一般会取决于两个种类：
1、electronic ground state 基态电子
2、electronic excited state 激发态电子</p>

<p>原因是；原子核质量远大于电子，因此相对于电子来说可以基本看作静止
这就是Born-Oppenheimer approximation</p>

<p>电子最低能量态决定了原子核的结构
the lowest energy state of the elctrons determines the spatial structure of nuclei:</p>

<h3 id="bonding">bonding：</h3>
<p>一般认为分为5类：
closed shell system:稀有气体
ionic
metallic
covalent
hydrogen:比较特殊，因为氢原子是唯一没有core electron的 （往上面的氦的core electron是1s的两个电子）</p>

<p>实际材料的bonding一般是这五种的结合</p>

<h3 id="hartree-atomic-units">Hartree atomic units</h3>

\[\hbar =m_e = e = 4\pi /\epsilon_0 = 1\]

<p>定义以上单位为1，用来简化计算</p>

<h1 id="晶体学知识-crystallography">晶体学知识 crystallography</h1>

<p>参考书：Richard M. Martin <em>Electronic structure: Basic theory and practical method</em></p>

<p>A crystal can be completely specified by the types and positions of the nuclei in <strong>one repeat unit (primitive unit cell)</strong> annd the rules that describe the <strong>repetition (translation)</strong></p>

<p>primitive cell有很多种，wigner seitz cell是其中一种</p>

<p>Wigner Seitz cell: the most compact cell that is symmetric about the origin <strong>注意 wigner seitz cell是在real space/实空间</strong></p>

<p>wigner seitz cell在倒空间对应的是<strong>first brillouin zone</strong></p>

<p><em>fcc 的 wigner seitz cell是bcc的first brillouin zone</em></p>

<h2 id="fourier-transformation">fourier transformation</h2>

<p><img src="/vasp_basic/pic/Fourier_series_and_transform.gif" alt="Image" />
转载自 wikipedia
<img src="/vasp_basic/pic/40cf849e55ed95732a60b52d4019d609_720w.jpg" alt="Image" />
转载自_https://zhuanlan.zhihu.com/p/19763358_，这个讲的很清楚</p>

<h2 id="reciprocal-sapce-倒易空间">reciprocal sapce 倒易空间</h2>

<p>考虑任何一个描述晶体性质的方程（比如说电子密度）</p>

<p>由于晶体的周期性，在实空间电子密度是周期性相同的,也就是说对于电子密度\(n(r+T(r'))=n(r)\)其中T是任何的translation操作</p>

<h3 id="一维理解">一维理解</h3>

<p>对于一个一维的，总共三个晶格的晶体，晶格常数为a</p>

<p>—《原子》—a—《原子》—a—《原子》—</p>

<p><img src="/vasp_basic/pic/pic1.jpg" alt="Image" /></p>

<p>那么电子密度n(x)必须满足：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>n(x)    =    n(x+a)       =n(x+2a)  
</code></pre></div></div>

<p>当0&lt;x&lt;a</p>

<p>因为n(x)有这样的周期性，所以一定可以对其进行傅里叶变化</p>

<p>傅里叶变化是从x空间变为q空间\(n(x)-&gt;n(q)\)</p>

<p>对于这个长度为3的一维晶体，其中含有3个cell，那么晶格个数N=3</p>

<p>从x空间到q空间的傅里叶变化是</p>

\[n(q)=\frac{1}{\Omega_{crystal}}\int_{\Omega_{crystal}} dxn(x)exp(iq·x)\]

<p>代入条件</p>

\[n(q)=\frac{1}{3a}\int_0^{3a} dxn(x)e^{(iq·x)}\]

<p>对于每一个晶格内部进行积分</p>

\[n(q)=\frac{1}{3a}(\int_0^adxn(x)e^{iq·x} +\int_a^{2a}dxn(x)e^{iq·x}+\int_{2a}^{3a}dxn(x)e^{iq·x})\]

\[n(q)=\frac{1}{3a}(\int_0^adxn(x)e^{iq·x} +\int_0^{a}dxn(x+a)e^{iq·(x+a)}+\int_{0}^{a}dxn(x+2a)e^{iq·x+2a})\]

<p>由于n(x)周期性n(x)=n(x+a)=n(x+2a)</p>

\[n(q)=\frac{1}{3a}(\int_0^adxn(x)e^{iq·x} +\int_0^{a}dxn(x)e^{iq·(x+a)}+\int_{0}^{a}dxn(x)e^{iq·x+2a})\]

<p>把exp拆开</p>

\[n(q)=\frac{1}{3a}(\int_0^adxn(x)e^{iq·x} +\int_0^{a}dxn(x)e^{iq·x}e^{iq·a}+\int_{0}^{a}dxn(x)e^{iq·x}e^{iq·2a})\]

<p>合并得到</p>

\[n(q)=\frac{1}{3a}(e^{iq·0a}+e^{iq·a}+e^{iq·2a})(\int_0^adxn(x)e^{iq·x})\]

<p>从而得到三维大晶体的一般形式：</p>

\[f(q)=\frac{1}{\Omega_{crystal}}\sum_0^{N_xa1}\sum_0^{N_ya2} \sum_0^{N_za3}  e^{iq·T(n1,n2,n3)} \int_0^{a1} \int_0^{a2} \int_0^{a3} dxdydzf(x,y,z) e^{iq·(x,y,z)}\]

\[f(q)=\frac{1}{\Omega_{crystal}}\sum e^{iq·T} \int drf(r) e^{iq·r}\]

<p>T是所有可能的平移（translation）操作</p>

<h3 id="倒空间的有意义的点q需要满足的条件">倒空间的有意义的点q需要满足的条件</h3>

<p>根据Born-Von Karmen条件，傅里叶变化后的每一个component都必须满足 \(exp(i q·Na)=1\)</p>

<p>为了满足\(exp(iq·3a) =1\)，则必须有：</p>

\[q·a=2\pi \frac{integer}{3}\]

<p>对于三维大晶体，\(q·a=2\pi \frac{integer}{N}\)</p>

<p>N是一个很大的值，所以大晶体的q点是连续的</p>

<h3 id="一维小晶体的倒空间与布里渊区">一维小晶体的倒空间与布里渊区</h3>

<p>继续对于\(q·a=2\pi \frac{integer}{3}\)</p>

<p>尝试当interger=1</p>

\[q·a=\frac{2\pi}{3}\]

\[q=\frac{2\pi}{3a}\]

\[n(q)=\frac{1}{3a}(e^{0}+e^{\frac{i2\pi}{3}}+e^{\frac{i4\pi}{3}})(\int_0^adxn(x)e^{iq·x})\]

<p>然而</p>

\[e^{0}+e^{\frac{i2\pi}{3}}+e^{\frac{i4\pi}{3}}=0\]

<p>所以\(n(\frac{2\pi}{3a})=0\)</p>

<p>之后发现只有当\(q·a=2\pi · integer\)时（而非\(q·a=2\pi \frac{integer}{3}\)）</p>

<p>n(q)才有</p>

\[n(q)=\frac{1}{3a}(e^{2\pi}+e^{2\pi}+e^{2\pi})(\int_0^adxn(x)e^{2\pi})\]

\[n(q)=\frac{1}{3a}(1+1+1)(\int_0^adxn(x)*1)\]

<p>也就是说，是个非0的fourier component</p>

<p>从而定义单位倒易矢量\(b=\frac{2\pi}{a}\)</p>

<p>使n(r)的fourier component 非0的q的集
合记为G（倒易空间），</p>

\[G(m)=m * b\]

<p>其中m为任意正整数，且m=0 为基态</p>

<p>第一布里渊区是倒空间的wigner-seitz cell</p>

<p>同样用上面的3a大小的一维晶体距离</p>

<p>注意倒空间是无限长的一维空间,倒空间两个相邻格点之间距离为\(b=\frac{2\pi}{a}\)</p>

<p>第一布里渊区是</p>

\[-\frac{\pi}{a}&lt;q&lt;+\frac{\pi}{a}\]

<p>q=0对应了基态</p>

<p><strong>注意：这些是基态的条件</strong></p>

<h3 id="三维大晶体的倒空间与布里渊区">三维大晶体的倒空间与布里渊区</h3>

<p>\(n(x+x',y+y',z+z')=n(x,y,z)\)，其中x’ y’ z’是整数倍的\(a_1 a_2 a_3\)</p>

<p>\(a_1 a_2 a_3\)是三个晶格向量</p>

<p>傅里叶变化可以对所有有周期性性质的函数使用</p>

<p>因为n(r)有这样的周期性，所以一定可以对其进行傅里叶变化</p>

<p>傅里叶变化是\(n(r)-&gt;n(q)\)</p>

<p>对于一个体积为\(\Omega\)的三维晶体，其中含有\(N_x \times N_y \times N_z = N_{cell}\)个cell的体系</p>

<p>根据Born-Von Karmen条件，傅里叶变化后的每一个component都要满足 \(exp(iq· N_x a_1)=exp(iq· N_ya_2)=exp(iq· N_z a_3)=1\)</p>

<p>为了满足\(exp(iq· N_x a_1)=exp(iq· N_ya_2)=exp(iq· N_z a_3)=1\)，则必须有：</p>

\[q·(a_1,a_2,a_3)=2\pi \frac{integer}{N_i}\]

<p>从r到q的傅里叶变化是</p>

\[f(q)=\frac{1}{N_{cell}\Omega_{cell}}\sum e^{iq·T} \int drf(r) e^{iq·r}\]

<p>通过计算，使f(q)非零需要满足的条件是</p>

\[q·(a_1,a_2,a_3)=2\pi · integer\]

<p>从而确立了倒空间的基矢，
\(G(m_1,m_2,m_3)=m_1b_1,m_2b_2,m_3b_3\)</p>

<p>其中\(m_1,m_2,m_3\)是任意整数，\(b_1,b_2,b_3\)是\(a_1 a_2 a_3\)的倒向量</p>

<h2 id="bloch-theorem的推导">bloch theorem的推导</h2>

<h3 id="bloch-theorem第一种证明">bloch theorem第一种证明</h3>

<p>根据一通看不懂的证明（P87~P88, section 4.4 Richard M. Martin <em>Electronic structure: Basic theory and practical method</em>）</p>

<p>继续考虑一维情况，对于一个算符，比如说\(\hat{H}\)作用在电子波函数上，得到电子能量。\(\hat{H}\)是算符，\(\epsilon\)是本征态\(\phi(x)\)是本征方程
\(\hat{H}\phi(x)=[-\frac{\hbar^2}{2m_e }\nabla^2+V(r)]\phi(x)=\epsilon\phi(x)\)</p>

<p>类似得，可以定义translation算符\(\hat{T_x}\),角标x代表一维的x轴上的translation</p>

\[\hat{T}_{x_0}\phi(x)=\phi(x+x_0)\]

<p>不知道为什么但是hamiltonian \(\hat{H}\)与\(\hat{T_x}\)是commute的</p>

\[\hat{H}\hat{T_x}=\hat{T_x}\hat{H}\]

<p>由于commute，\(\hat{H}\)的本征态也是\(\hat{T_x}\)的本征态</p>

<p>另外由于\(\hat{T}_{x_0}\hat{T}_{x_1}=\hat{T}_{x_0+x_1}\)</p>

<p>(显然分别挪了x0和x1的操作与一下子挪了x0+x1的操作结果是一样的)</p>

<p>则一定有\(\hat{T}_{x_0+x_1}\phi(x)=\hat{T}_{x_0}\hat{T}_{x_1}\phi(x)=t_{(x_0+x_1)}\phi(x)=(t_{x_0}+t_{x_1})\phi(x)\)</p>

<p>由于如下看不懂的原因：
<strong>modules of t(x) must be unity 模必须为1？？</strong></p>

<p><strong>且本征方程必须满足周期性</strong></p>

<p>所以<strong>t(x)必须有\(t(x)=e^{ik·T_x}\)格式</strong></p>

<p>其中\(T_x\)是x轴上移动的距离，\(k=\frac{integer\times b}{cell总数}=\frac{2n\pi}{3a}\).其中n是任意整数integer，b是倒易空间单位矢量</p>

<p>由此有bloch theorem：</p>

<p><strong>\(\hat{T}_x\phi(x)=\phi(x+t_x)=e^{ik·T_x}\phi(x)\)</strong></p>

<h3 id="bloch-theorem的第二种证明">bloch theorem的第二种证明</h3>

<p>继续在之前的晶格常数为a总长度为3的一维晶体例子</p>

<p>由于势能一定具有晶格的周期性，晶格的周期性是整数倍的晶格常数，根据前面的Born-Von Karmen条件，一定可以将V(x)进行从x空间变换到k空间的傅里叶变换，变成成如下形式</p>

<p>\(V(x)=\sum _K v_K e^{iKx}\)其中\(v_K\)是系数,K是所有的倒易空间矢量（整数倍的\(\frac{2\pi}{a}\)）</p>

<p>这个变换是正确的，因为V(x)保留了周期性且周期性为a（晶格常数），有如下证明\(V(x+a)=\sum _K v_K e^{iK(x+a)}=\sum _K v_K e^{i\frac{2n\pi}{a}(x+a)}=\sum _K v_K e^{i\frac{2n\pi}{a}x}e^{i\frac{2n\pi}{a}a}=\sum _K v_K e^{i\frac{2n\pi}{a}x}*1=V(x)\)</p>

<p>傅里叶变换中的系数\(v_K=\frac 1v \int_{cell} dxe^{-iKx}V(x)\)
在此一维晶体\(v_K=\frac{1}{a} \int_{0}^{a} dxe^{-iKx}V(x)\)</p>

<p>取决于参照对象，势能是可以整体上升或者下降的（考虑同一高度对于1、地面和2、珠穆朗玛峰 的重力势能），为了计算方便要求\(v_0=0\)</p>

<p>也就是说\(v_0=\frac{1}{a} \int_{0}^{a} dxe^{-i*0*x}V(x)=\frac{1}{a} \int_{0}^{a} V(x)dx\)</p>

<p>由于V(x)是实数方程，要求有\(v_K=v_{-K}=v_K*\)</p>

<p>由于电子在接近原子核处势能高，离开原子核处势能低，而且势能是周期性的</p>

<p>非常粗浅地假设势能是cos形式 \(V(x)=-cos\frac{2\pi x}{a}\)</p>

<p><img src="/vasp_basic/pic/pic1.jpg" alt="Image" /></p>

<p>此时可以得到V(x)有精确的傅里叶展开是（对于其他一般的V(x)难以得到精确展开，只是举个例子）</p>

\[V(x)=-cos\frac{2\pi x}{a}=-(0.5cos\frac{2\pi x}{a}+0.5isin\frac{2\pi x}{a})-(0.5cos\frac{2\pi x}{a}-0.5isin\frac{2\pi x}{a})=-0.5e^{\frac{i2\pi}{a}x}-0.5e^{\frac{-i2\pi}{a}x}\]

<p>也就是说当\(K=2\pi/a以及K=-2\pi/a\) 时\(v_k=-0.5\)，对其他K值\(v_k=0\)</p>

<p>根据前面的Born-Von Karmen条件，也可以将单电子波函数（本征方程）进行类似的变换。注意波函数本身未必具有周期性，所以只是普通的傅里叶展开.\(c_q\)是每个展开的系数</p>

\[\phi(x)=\sum _q c_qe^{iqx}\]

<p>将以上代入薛定谔方程得到</p>

<p>有\(\hat{H}\sum_q c_qe^{iqx}=[-\hbar^2 \nabla^2 /2m + (-0.5e^{\frac{i2\pi}{a}x}-0.5e^{\frac{-i2\pi}{a}x})]\sum_q c_qe^{iqx}\)</p>

\[=\frac{\hbar^2}{2m} \sum _q q^2c_qe^{iqx}+ \sum_q -0.5c_qe^{i(q+\frac{2\pi}{a})x} + \sum_q -0.5c_qe^{i(q+\frac{-2\pi}{a})x}=\epsilon \sum _q c_qe^{iqx}\]

<p>由于一个不知道的原因（需要后面再进行理解，或许是因为傅里叶展开的q是从负无穷到正无穷所以无所谓？）
\(\sum_q -0.5c_qe^{i(q+\frac{2\pi}{a})x} =\sum_{q'}-0.5c_{q'-\frac{2\pi}{a}}e^{iq'r}=\sum_q-0.5c_{q-\frac{2\pi}{a}}e^{iqr}\)
\(\sum_q -0.5c_qe^{i(q+\frac{-2\pi}{a})x} =\sum_{q'}-0.5c_{q'-\frac{-2\pi}{a}}e^{iq'r}=\sum_q-0.5c_{q-\frac{-2\pi}{a}}e^{iqr}\)</p>

<p>代入上式</p>

<p>\(\frac{\hbar^2}{2m} \sum _q q^2c_qe^{iqx}+ \sum_q -0.5c_qe^{i(q+\frac{2\pi}{a})x} + \sum_q -0.5c_qe^{i(q+\frac{-2\pi}{a})x}=\epsilon \sum _q c_qe^{iqx}\)
\(\frac{\hbar^2}{2m} \sum _q q^2c_qe^{iqx}+ \sum_q-0.5c_{q-\frac{2\pi}{a}}e^{iqr} + \sum_q-0.5c_{q-\frac{-2\pi}{a}}e^{iqr}=\epsilon \sum _q c_qe^{iqx}\)
\(\sum _q e^{iqx}[(\frac{\hbar^2}{2m}q^2-\epsilon)c_q+(-0.5c_{q-\frac{2\pi}{a}})+(-0.5c_{q-\frac{-2\pi}{a}})]=0\)</p>

<p>最后得到了动量空间的薛定谔方程，形式如下
\((\frac{\hbar^2}{2m}q^2-\epsilon)c_q+(-0.5c_{q-\frac{2\pi}{a}})+(-0.5c_{q-\frac{-2\pi}{a}})=0\)</p>

<p>对于任意的V(x),薛定谔方程的一般形式为
<strong>\((\frac{\hbar^2}{2m}q^2-\epsilon)c_q+\sum_{K'}v_{K'}c_{q-K}=0\)</strong></p>

<p>\(c_q\)是单电子波函数傅里叶变换的展开项系数，是未知量，q在这里是自变量，是倒易空间中的倒易矢量（任意分数/整数倍的\(\frac{2\pi}{a}\)）。对于每一个倒易矢量q，这个动量空间薛定谔方程都（大概）是可解的，得到了每个q对应的\(c_q\)值，从而获得单电子波函数在空间的比较严格的表达形式\(\Phi(x)=\sum _q c_qe^{iqx}\)。此式也被称为wannier functions</p>

<p>显然倒空间的q有无限多个，计算上面是不可能实现的。所以只取一部分的q点进行计算。vasp的k point就是用来定义取的q点，也就是说，如果把q取值范围限定成这样的一系列点的集合：\(q_k \in [k+K,k是第一布里渊区中的一个有效点,K是整数倍的 \frac{2\pi}{a}]\)，比如说\(q_\frac{2\pi}{3a} \in  [\frac{2\pi}{3a}, \frac{2\pi}{a}+\frac{2\pi}{3a},\frac{4\pi}{a}+\frac{2\pi}{3a},\frac{6\pi}{a}+\frac{2\pi}{3a},.......]\)</p>

<p>把这个限制条件代入\(\phi(x)=\sum _q c_qe^{iqx}\)</p>

<p>可以得到限定条件中规定的点k所对应的单电子波函数，即</p>

\[\phi(x,k)=\sum _{q_k} c_{q_k}e^{iq_kx}\]

<p>将\(q_k\)限定条件代入可以写作如下格式</p>

\[\phi(x,k)=\sum _K c_{k+K\times \frac{2\pi}{a}} e^{i(k+K)x}\]

<p>例如</p>

\[\phi(x,\frac{2\pi}{3a})=c_{\frac{2\pi}{3a}} e^{i(\frac{2\pi}{3a})x}+c_{\frac{2\pi}{3a}+\frac{2\pi}{a}} e^{i(\frac{2\pi}{3a}+\frac{2\pi}{a})x}+c_{\frac{2\pi}{3a}+\frac{4\pi}{a}} e^{i(\frac{2\pi}{3a}+\frac{4\pi}{a})x}+....\]

<p>提取公因数</p>

\[\phi(x,\frac{2\pi}{3a})=c_{\frac{2\pi}{3a}} e^{i(\frac{2\pi}{3a})x}+c_{\frac{2\pi}{3a}+\frac{2\pi}{a}} e^{i(\frac{2\pi}{3a})x}e^{\frac{2\pi}{a}x}+c_{\frac{2\pi}{3a}+\frac{4\pi}{a}} e^{i(\frac{2\pi}{3a})x}e^{\frac{4\pi}{a}x}+....\]

<p>整理得到</p>

\[\phi(x,\frac{2\pi}{3a})=e^{i(\frac{2\pi}{3a})x}[c_{\frac{2\pi}{3a}} e^{i*0*x}+c_{\frac{2\pi}{3a}+\frac{2\pi}{a}}e^{\frac{2\pi}{a}x}+c_{\frac{2\pi}{3a}+\frac{4\pi}{a}}e^{\frac{4\pi}{a}x}+....]\]

<p>也就是说</p>

\[\phi(x,k)=e^{ikx}\sum _K c_{k+K} e^{iKx}\]

<p>令\(u(x,k)=\sum _K c_{k+K} e^{iKx}\)</p>

<p>可以看到\(u(x,k)\)是一种傅里叶展开的形式，而且\(e^{iKx}\)项说明u(x,k)在x轴上具有周期性，且周期性为晶格常数a，与势能的周期性相同</p>

<p>这样得到了bloch theorem第二种说法是：
<strong>对于单电子的hamiltonian \(\hat{H}=[-\hbar^2 \nabla^2 /2m + V(r)]\),若其中V（r）为势能项且具有布拉维晶格的周期性，则这个Hamiltonian的本征方程一定可以被如下的形式写出：</strong></p>

<p><strong>\(\phi(x,k)=e^{ikx}u(x,k)\)</strong></p>

<p><strong>需要注意：本征方程可以如此写出，但是这个本征方程并不一定代表单电子波函数的方程，这个方程仅代表单电子在点k所对应的波函数。而完整单电子波函数方程是wannier function：\(\Phi(x)=\sum _{brillouin zone} c_qe^{iqx}\)。</strong></p>

<p>继续假设\(u(x,k)=sin(x)\)或者具有类似形式（显然并不是的，因为u(x,k)估计是个复函数，只是为了画图）</p>

<p>根据前面的Born-Von Karmen条件，</p>

\[k=2\pi \frac{integer}{N_{cell}a}\]

<p>则对于k=0</p>

<p>单电子波函数为\(\phi(x,0)=e^{i*0*x}u(x,k)\)</p>

<p>下一个是\(k=\frac{2\pi}{3a}\)</p>

<p>即\(k=\frac{2\pi}{3a}\)对应的单电子波函数是
\(\phi(x,\frac{2\pi}{3a})=e^{i\frac{2\pi x}{3a}}sin(x)\)</p>

<p>再下一个\(k=\frac{4\pi}{3a}\)时注意第一布里渊区是\(\frac{-\pi}{a}&lt;k&lt;\frac{\pi}{a}\),此时已经超过了第一布里渊区</p>

\[\phi(x,\frac{4\pi}{3a})=e^{i\frac{4\pi x}{3a}}sin(x)\]

\[k=\frac{2\pi}{a}\]

\[\phi(x,\frac{2\pi}{a})=e^{i\frac{2\pi x}{a}}sin(x)\]

<p>画出来是这样的。这里看起来不太合理，但是一定注意u(x)本身是个复函数，而且前提假设“晶体只有三个原子”本身并不成立。这个图只为了显示大概的形式</p>

<p><img src="/vasp_basic/pic/pic2.jpg" alt="Image" /></p>

<h4 id="block-theorem单电子波函数的本征值和周期性">block theorem单电子波函数的本征值和周期性</h4>

<p>对于bloch theorem 的 \(\phi(x,k)=e^{ikx}u(x,k)\)形式，求其能量</p>

<p>有\(\hat{H}\phi(x,k)=[-\hbar^2 \nabla^2 /2m + V(r)]\phi(x,k)\)</p>

<p>将\(\phi(x,k)=e^{ikx}u(x,k)\)代入</p>

\[\hat{H}e^{ikx}u(x,k)=\frac{-\hbar^2}{2m} \frac{d^2e^{ikx}u(x,k)}{dx^2} + V(r)e^{ikx}u(x,k)\]

\[\hat{H}e^{ikx}u(x,k)=\frac{-\hbar^2}{2m} \frac{d[ike^{ikx}u(x,k)+e^{ikx}u'(x,k)]}{dx} + V(r)e^{ikx}u(x,k)\]

\[\hat{H}e^{ikx}u(x,k)=\frac{-\hbar^2}{2m}[ -k^2e^{ikx}u(x,k)+ike^{ikx}u'(x,k)+ike^{ikx}u'(x,k)+e^{ikx}u''(x,k)] + V(r)e^{ikx}u(x,k)\]

<p><strong>得到\(\hat{H}u(x,k)=\frac{-\hbar^2}{2m}[ -k^2u(x,k)+2iku'(x,k)+u''(x,k)] + V(r)u(x,k)=\epsilon _ku(x,k)\)</strong></p>

<p>从里面抽出来Hamiltonian\(\hat{H}=\frac{-\hbar^2}{2m} (\frac 1i \nabla+k)^2  + V(r)\)</p>

<p>前面限定了k是在第一布里渊区，但是即使k不再局限于第一布里渊区，显然依旧能够在第一布里渊区找到与其完全对应的波函数</p>

\[\phi(x,\frac{2\pi}{a}+\frac{2\pi}{3a})=...+c_{\frac{2\pi}{3a}+\frac{2\pi}{a}} e^{i(\frac{2\pi}{3a}+\frac{2\pi}{a})x}+c_{\frac{2\pi}{3a}+\frac{4\pi}{a}} e^{i(\frac{2\pi}{3a}+\frac{4\pi}{a})x}+...=...+c_{\frac{2\pi}{3a}} e^{i(\frac{2\pi}{3a})x}+c_{\frac{2\pi}{3a}+\frac{2\pi}{a}} e^{i(\frac{2\pi}{3a}+\frac{2\pi}{a})x}+c_{\frac{2\pi}{3a}+\frac{4\pi}{a}} e^{i(\frac{2\pi}{3a}+\frac{4\pi}{a})x}+.....=\phi(x,\frac{2\pi}{3a})\]

<p>也就是说\(\phi(x,k)\)在k空间也有周期性，周期性为单位倒易矢量，或者说，具有如下性质(添加的这个n是能级)</p>

\[\phi(x,n,k)=\phi(x,n,k+K)\]

<p>这就使得其本征值（能量）以及block theorem中的u(x,k)同样具有这个性质</p>

<p>\(\epsilon(n,k)=\epsilon(n,k+K)\)
\(u(x,k)=u(x,k+K)\)</p>

<h2 id="k-point取样">k point取样</h2>

<p>继续考虑一维情况，已知从x到q有傅里叶变换 
\(n(q)=\frac{1}{\Omega_{crystal}}\int_{\Omega_{crystal}} dxn(x)exp(iq·x)\)</p>

<p>那么从q到x也有傅里叶变换<strong>注意：正负号很可能错了，需要以后勘误</strong></p>

\[n(x)=\frac{1}{\Omega_{k space}}\int_{\Omega_{k space}} dqn(q)exp(ix·q)\]

<p>虽然不知道n(q)是干什么的，但是n(x)是我们想要求的电子密度</p>

<p>\(n(x)=\frac{1}{\Omega_{k space}}\int_{\Omega_{k space}} dqn(q)exp(ix·q)\)这个公式中，可以看到想要求的是一个积分。显然积分是很难求的，所以考虑积分的定义</p>

<p>积分可以理解为：函数与x轴（在这个公式里面是与q轴）围出的面积</p>

<p>那么可以将积分用取样点离散化</p>

<h3 id="trapezoidal-method">trapezoidal method</h3>
<p>trepezoidal 方式拟合积分公式，对区域内进行均匀取样
\(\int _{-1}^1f(x)dx \approx \frac{1}{n}[f(-1)+2\sum_{j=1}^{n-1}f(x_j)+f(1)]\)</p>

<p>比如当n=4情况</p>

\[\int _{-1}^1f(x)dx \approx 0.25f(-1)+0.25f(-0.5)+0.25f(0)+0.25(0.5)+0.25(1)\]

<h3 id="gaussian-quadrature">Gaussian quadrature</h3>

<p>\(\int _{-1}^1f(x)dx \approx 0.25f(-1)+0.25f(-0.5)+0.25f(0)+0.25(0.5)+0.25(1)\)可以转为如下公式，此时取样点是不均匀分布的</p>

\[\int _{-1}^1f(x)dx \approx \sum_{j=1}^n c_j f(x_j)\]

<p>不均匀分布的取样点是Gaussian quadrature，\(c_j\)是系数，由Gaussian quadrature来规定。</p>

<h1 id="hubbard-model">Hubbard model</h1>

<h2 id="dftu">DFT+U</h2>

<p>ref: <em>correlated electrons in quantum matter</em></p>

<p>LDA计算结果准确的前提是其电子有效质量\(m^* \approx  m^e\)，然而对于strong correlated electron (heavy quasiparticles)时候\(m^* &gt;&gt; m^e\),导致结果不准确</p>

<p>对于d和f电子，需要有U参数，这个U参数使得：在向d或者f shell添加电子时，所需要能量要远大于fermi energy。这是由于其他d或者f电子的排斥产生的。</p>

<h3 id="u参数计算方式">U参数计算方式</h3>
<p>假设在一个site上面有n个电子，这n个电子之间会互相排斥。这个排斥的能量是
\(E(n)=\frac{n(n-1)}{2}U\)</p>

<p>可以用以下方法通过LDA来计算U参数：
设定“the hybridization matrix elements of the atomic like d orbitals with the surroundings, equal to zero”。然后，在一次计算中固定d电子数量\(n_{d_0}\)，然后让其他电子relax并计算其能量。在下一次计算中固定d电子数量为\(n_{d_0}+1\)，计算能量。因为\(U=E(n+1)+E(n-1)-2E(n) \approx \frac{d^2E(n_d)}{d_{n_d}^2}\)，所以通过改变\(n_d\)并计算\(E(n_d)\)对\(n_d\)的二阶导，可以得到U的值。这个值是6~8eV</p>

<h3 id="u-parameter-meaningtranslated">U parameter meaning(translated)</h3>

<p>The U parameter is working as: Additional energy required to add electron to d or f shell for the transitional metals due to the mutual expulsion by other d or f electrons.</p>

<p>one way to calculate the U parameter: from the equation \(U=E(n+1)+E(n-1)-2E(n) \approx \frac{d^2E(n_d)}{d_{n_d}^2}\)</p>

<p>For each run: the number of d(or f shell) electron is fixed and calculate the energy. By varying the d electron, calculate the relation between DFT energy and the number of d electron: \(U=\frac{d^2E(n_d)}{d_{n_d}^2}\)</p>

<p>some other methods: machine learning</p>

<p>There is also a J term for the spin states. The J depends on whether the two spins are parallel or antiparallel.</p>

<h1 id="dft-实践">DFT 实践</h1>

<h2 id="压缩模量-bulk-modulus">压缩模量 bulk modulus</h2>

<p>通过更改晶格常数得到不同的E可以计算压缩模量B</p>

\[B=V^2\frac{d^2E_{DFT}}{dV^2}\]

<p>实际操作上也有一些其他公式来计算，比如Birch-Murnaghan equation</p>

\[E_{tot}(a)=E_0+\frac{9V_0B_0}{16}\{[(\frac{a_0}a)^2-1]^3 \frac{dB}{dP}|_T +[(\frac{a_0}a)^2-1)]^2[(6-4(\frac{a_0}a)^2]\}\]

<h2 id="分析表面-slab-models">分析表面-slab models</h2>
<p>surface是二维结构而dft是三维计算。因此建立一个在z方向有多个重复周期，但只有部分重复周期有原子的supercell（比如说是\(1*1*8\)的supercell，1~5层有原子，用于分析表面5层的性质，其余3层没有原子（vaccum space）使得此处电子密度约等于0），由此在分析其周期性时z方向上的supercell之间没有相互作用。</p>

<h2 id="kpoint的数量">kpoint的数量</h2>
<p>对于\(1*1*1\)的supercell和\(1*2*10\)的supercell所需要的kpoint是不一样的。保证两者的kpoint在空间中的密度接近即可，比如前者要\(10*10*10\)的kpoint，后者要\(10*5*1\)即可</p>

<h2 id="energy-cutoff">energy cutoff</h2>

<p>k对应的波函数\(\phi(x,k)=e^{ikx}\sum _K c_{k+K} e^{iKx}\)。此电子波函数所对应的能量本征值为\(E=\frac{\hbar}{2m}|k+K|^2\)，由于K是任意倒易单位矢量，所以E有无数多个，但是显然只有较低能量的是有效的（电子不会占用高能量）。所以设定了cutoff使得
\(E_{cutoff}=\frac{\hbar}{2m}G_{cut}^2\)
这样对于给定的cutoff，可以得到k的新的波函数
\(\phi(x,k)=e^{ikx}\sum _{|k+K|&lt;G_{cut}} c_{k+K} e^{iKx}\)</p>

<h3 id="hard-and-soft-psudopotential">hard and soft psudopotential</h3>
<p>不同的赝势所需要的cutoff不一样，hard pseudopotential需要设定高的energy cutoff，soft pseudopotential只需要比较小的cutoff。目前用的应该都是ultrasoft pseudopotential</p>

<h2 id="optimization-method">optimization method</h2>
<p>比如在寻找晶格常数的时候，DFT进行的是optimization，寻找能量最低时候所对应的晶格常数。另外，能量的极小值等同于导数等于0。所以寻找导数等于0的点是等效的</p>
<h3 id="bisection-method">bisection method</h3>
<p>二分法进行递归寻找</p>

<h3 id="newton-method">newton method</h3>
<p>对于一维情况，假如说能量是晶格常数x的函数f(x)。通过newton method寻找能量最低值，亦或者说\(f'(x)=0\)的方法是：</p>

<p>对\(f'(x)\)进行泰勒展开得到
\(f'(x+dx)\approx f'(x)+dxf''(x)\)
令dx=h时\(f'(x+h)\approx f'(x)+hf''(x)=0\)
从而得到\(f'(x)\approx 0\)的x的计算方法：
\(x^*=x+h=x-\frac{f'(x)}{f''(x)}\)
得到\(x^*\)后代会x进行迭代计算。此方法收敛速度快于bisection</p>

<p>对于三维情形，newton method过于复杂无法操作。对于含有N个原子的晶胞，\(\frac{f'(x)}{f''(x)}\)会变成一个3Nx3N的矩阵</p>
<h3 id="quasi-newton-method">quasi-newton method</h3>
<p>quasi newton method 中，将f’’()的矩阵换成了一个估算的A矩阵
\(a_1,b_1,c_1=a_0,b_0,c_0-\frac{E'(a,b,c)}{A_1}\)
其中
\(A_1=A_0+F[a_1,b_1,c_1,G(a_1,b_1,c_1),E'(a_0,b_0,c_0)]\)
在不同的quasi newton方法中F[]是不一样的，取决于算法的规定。</p>

<h3 id="conjugate-gradient-methodsteepest-descent-method">conjugate-gradient method/steepest descent method</h3>

<p>是不停的向f’(x)移动的算法</p>

<p>initial guess:\((a_0,b_0,c_0)\)</p>

<p>1st guess:\((a_1,b_1,c_1)=(a_0,b_0,c_0)-\alpha_0d_0\)
\(d_0= (-\frac{dE(a,b,c)}{da},
-\frac{dE(a,b,c)}{db},-\frac{dE(a,b,c)}{dc})|_{(a_0,b_0,c_0)}\)</p>

<p>2nd guess:\((a_2,b_2,c_2)=(a_1,b_1,c_1)+\alpha_1d_1\)</p>

\[d_1=(-\frac{dE(a,b,c)}{da},-\frac{dE(a,b,c)}{db},-\frac{dE(a,b,c)}{dc})|_{(a_1,b_1,c_1)}+\frac{(-\frac{dE(a,b,c)}{da},-\frac{dE(a,b,c)}{db},-\frac{dE(a,b,c)}{dc})|_{(a_1,b_1,c_1)}·d_0}{d_0·d_0} (\frac{dE(a,b,c)}{da},\frac{dE(a,b,c)}{db},\frac{dE(a,b,c)}{dc})|_{(a_0,b_0,c_0)}\]

<h1 id="reference-book-参考书">reference book 参考书</h1>

<p>David S. Sholl, <em>Density functional Theory</em></p>

<p>Kittel, <em>solid state physics</em></p>

<p>Dehoff <em>Thermodynamics</em></p>

<p>Peter Fulde <em>Correlated Electrons in Quantum Matter</em></p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Syntax highlighted code block

<span class="gh"># Header 1</span>
<span class="gu">## Header 2</span>
<span class="gu">### Header 3</span>
<span class="p">
-</span> Bulleted
<span class="p">-</span> List
<span class="p">
1.</span> Numbered
<span class="p">2.</span> List

<span class="gs">**Bold**</span> and _Italic_ and <span class="sb">`Code`</span> text

<span class="p">[</span><span class="nv">Link</span><span class="p">](</span><span class="sx">url</span><span class="p">)</span> and !<span class="p">[</span><span class="nv">Image</span><span class="p">](</span><span class="sx">src</span><span class="p">)</span>
</code></pre></div></div>


  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Personal webpage</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Personal webpage</li><li><a class="u-email" href="mailto:davidnormal@126.com">davidnormal@126.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/lamdalamda"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">lamdalamda</span></a></li><li><a href="https://www.twitter.com/unknown"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">unknown</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
</script>

  <!--KaTeX-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
              // ...options...
          });
      });
  </script>